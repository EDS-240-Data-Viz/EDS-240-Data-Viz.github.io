---
title: "Fundamental chart types (evolution & amounts / rankings)"
subtitle: "Week 3"
description: "Wednesday January 21^st^, 2026"
---

```{r}
#| eval: true 
#| echo: false
#| fig-align: "center"
#| out-width: "80%" 
#| fig-alt: "A stacked area chart of drought area in California from 2000 to 2025, showing percentage of land area in the state by the U.S. Drought Monitor categories, ranging from D0: Abnormaly Dry to D4: Exceptional."
knitr::include_graphics(here::here("images", "usdm.png"))
```

:::{.gray-text .center-text}
*[U.S. Drought Monitor](https://droughtmonitor.unl.edu/CurrentMap.aspx){target="_blank"}'s California assessment. Source: [Wikipedia](https://en.wikipedia.org/wiki/Droughts_in_California){target="_blank"}*. We'll talk about stacked area charts in this week's lecture and you'll recreate this viz during lab session.
:::

## {{< fa clipboard-list title="a clipboard with a To Do list" >}} Pre-class Prep {#pre-class-prep}

### A. Install required packages {#install-pkgs}

```{r}
#| eval: false
#| echo: true
#| code-line-numbers: false
install.packages("usethis") # for editing .Renviron (see step C. in pre-class prep)
install.packages("tidytuesdayR") # used to download TidyTuesday data
install.packages("tidycensus") # an R package that allows users to interface with a select number of the US Census Bureauâ€™s data APIs and return tidyverse-ready data frames
install.packages("scales") # provides the internal scaling infrastructure used by ggplot2, and gives you tools to override the default breaks, labels, transformations and palettes (installed automatically with {ggplot2} or {tidyverse})
```

### B. Download data {#download-data}

Save data to your class repo at `EDS-240-class-examples/week3/data/`:

|Lecture | Dataset title | Download link | Notes |
|--------|---------------|---------------|-------|
| 3.1 | Lyme Disease Cases by State or Locality | [download link](https://www.cdc.gov/lyme/media/files/2025/02/2023_CaseIncid-Lyme-Disease-Cases-by-State-or-Locality.csv) *([Google Drive backup link](https://drive.google.com/file/d/1Cyxx8_T-3Ih1BxrGJcD7ZxRREVUGkP6D/view?usp=sharing){target="_blank"}, in case CDC portal is unavailable)* | Data made available by the CDC (read more on the CDC's [Lyme Disease Surveillance Data page](https://www.cdc.gov/lyme/data-research/facts-stats/surveillance-data-1.html){target="_blank"}; see other available data under [Dashboard data files](https://www.cdc.gov/lyme/data-research/facts-stats/surveillance-data-1.html#:~:text=jurisdictions%20are%20incomplete.-,Dashboard%20data%20files,-Note%3A%20some){target="_blank"}) |
| 3.1 | US Census Bureau Population Estimates Program | **we'll use the `{tidycensus}` package to interface with the US Census Bureau's API and download the data programmatically (see step C, below, for setup instructions),** *however, in the event that the API is down, you can access a backup copy of the 2019 vintage on [Google Drive](https://drive.google.com/file/d/1eBmts5q1PaOz8yaGbyfZonzAfG_l5TA7/view?usp=sharing){target="_blank"}* | Read more about The Census Bureau's [Population Estimates Program (PEP)](https://www.census.gov/programs-surveys/popest.html){target="_blank"} |
| 3.2 | USGS National Water Availability Assessment Outputs (CONUS 2025) | download the combined IWA .csv file from the [National Water Availability Assessment Data Companion (NWDC)](combined_iwa-assessment-outputs-conus-2025_CONUS_200910-202009_long.csv){target="_blank"} *([Google Drive backup link](https://drive.google.com/file/d/1dtgqfB_62M0o0l8iHUs1enUUMyuZtUQ7/view?usp=drive_link){target="_blank"}, in case the NWDC is unavailable)* | These data are modeled estimates of monthly water supply and use (not empirical measurements from sensors / gauges); [Read more about the model & data](https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025){target="_blank"} |
: {.hover .bordered tbl-colwidths="[10,20,35,35]"} 

### C. Request a US Census Bureau API key & add it to your `.Renviron` file {#request-API-key}

1. To use the [`{tidycensus}` package](https://walker-data.com/tidycensus/){target="_blank} to access US Census Bureau data, you'll first need to **request and activate an API key**. Do so by following these steps:

    a. Request an API key at <http://api.census.gov/data/key_signup.html>{target="_blank}
    b. After a short period of time, you should receive an email with your key (it may be helpful to star / bookmark that email), and click the included link to activate your key (**Note:** if you get an error when activating your key, close your browser window and try clicking the activation link again).

2. **Add your API key to your `.Renviron` file**. For security purposes, you should *NEVER* push any API keys to GitHub. Rather than typing our API key into any of our scripts, we can instead save it to and read it from our `.Renviron` file. Follow these steps:

    a. Run `usethis::edit_r_environ()` in your Console, which will open up your `.Renviron` file (it will create it if you don't already have one).
    b. Store envrionment variables as key / value pairs. Add your API key as shown, below, then save and **restart R** for your changes to take effect.
    
```{r filename=".Renviron"}
#| eval: false
#| echo: true
#| code-line-numbers: false
# be sure to name it exactly as written here (all caps) 
CENSUS_API_KEY="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
```

- **Note:** You may also consider storing your API key in a password manager for safe keeping (e.g. in case your computer decides to call a quits, is lost, etc.) 

::: {.callout-note collapse=true}
## What exactly is `.Renviron`?

[Dotfiles](https://en.wikipedia.org/wiki/Hidden_file_and_hidden_directory){target="_blank"} (files which are preceded by a dot, `.`) are hidden files, which are broadly used to customize the behavior of programs. You may already be familiar with some dotfiles, such as `.gitconfig` and `.gitignore`.

**The `.Renviron` file is an R-specific dotfile, which is commonly used for (though not limited to) storing sensitive information, such as API keys.** It lives in your computer's home directory (e.g. `/Users/yourUserName` on macOS, or `C:/Users/yourUserName/Documents` on Windows), and is automatically sourced when an R session starts. When sourced, all stored variables (such as your API key) are made available to your R environment for you to use. Variables should be stored as key / value pairs (e.g. `KEY_NAME="VALUE"`. Access them using `Sys.getenv("KEY_NAME")`.

Oftentimes, packages that are built to interface with APIs will include their own helper functions for adding API keys to your `.Renviron` file (e.g. see [`tidycensus::census_api_key()`](https://walker-data.com/tidycensus/reference/census_api_key.html){target="_blank"}). You may choose to use these helper functions in place of `usethis::edit_r_environ()`, if you prefer.
:::

### D. Download `.qmd` templates & review initial data wrangling code {#download-templates}

1. Download all necessary templates (links in the table below) and save them to a `EDS-240-data-viz-examples/week3/` folder. 

2. Review the data wrangling code under the `## Setup` section of each template file and make note of any questions you might have. Due to time constraints, we won't be live-coding our way through the data wrangling code in class. However, we'll reserve some time to answer any questions before we jump into data viz {{< fa face-smile title="a smiling face" >}}.

## {{< fa person-chalkboard title="a person pointing at a chalkboard" >}} Lecture Materials {#lecture-materials}

| {{< fa person-chalkboard title="A person motioning at a chalkboard" >}} Lecture slides   | {{< fa file-code title="A code file" >}} Code-along template | {{< fa key title="A key" >}} Code-along key |
|------------------------------------------------------------------------------------------|--------------------------------------------------------------|---------------------------------------------------|
| [Lecture 3.1: visualizing evolution](lecture-slides/SLIDES-evolution.qmd){target="_blank"}  | [3.1 template](https://github.com/EDS-240-Data-Viz/code-along-templates/blob/main/TEMPLATE-evolution.qmd){target="_blank"} | [3.1 key](keys/KEY-evolution.qmd){target="_blank"} |
| [Lecture 3.2: visualizing amounts / rankings](lecture-slides/SLIDES-amounts-rankings.qmd){target="_blank"}  | [3.2 template](https://github.com/EDS-240-Data-Viz/code-along-templates/blob/main/TEMPLATE-amounts-rankings.qmd){target="_blank"} | [3.2 key](keys/KEY-amounts-rankings.qmd){target="_blank"} |
: {.hover .bordered tbl-colwidths="[50,25,25]"} 

## {{< fa clipboard-list title="a clipboard with a To Do list" >}} Pre-lab Prep {#pre-lab-prep} 

::: {.callout-important}
## TODO
- recreating USDM plot exercise is currently split into two parts (below & week 4) -- combine into one lab for this week
:::

### A. Prepare a `week3-lab.qmd` file

Add a new blank file to your class repo at the following location: `EDS-240-class-examples/week3/week3-lab.qmd.` Fill out the necessary YAML information (title, author, date + any other information you find helpful).

### B. (OPTIONAL) Install Chrome extension for picking colors

Install the [ColorZilla](https://chromewebstore.google.com/detail/colorzilla/bhlhnicpbhignbdhedgjhgdocnmhomnp){target="_blank"} Google Chrome extension (also available for [Firefox](https://www.colorzilla.com/firefox/){target="_blank"}), which makes it easy to select color values from webpages.

## {{< fa comments title="two speech bubbles" >}} Lab Materials {#lab-materials}

| {{< fa person-chalkboard title="A person motioning at a chalkboard" >}} Lab Slides | {{< fa file-code title="A code file" >}} Exercise instructions | {{< fa key title="A key" >}} Exercise solutions |
|-------------------|-------------------|--------------|
| [Lab 3 slides: USDM](lab/LAB-SLIDES-usdm-graphic-form.qmd){target="_blank"} | [Lab 3 exercise: recreate USDM viz](lab/LAB-EXERCISE-usdm-graphic-form.qmd){target="_blank"} | [Lab 3 solution](lab/LAB-SOLUTION-usdm-graphic-form.qmd){target="_blank"} |
: {.hover .bordered tbl-colwidths="[35,35,30]"} 

## {{< fa pencil title="pencil" >}} Assignment Reminders {#assignment-reminders}

| Assignment Type | Assignment Title                                    | Date Assigned  | Date Due                   |
|-----------------|-----------------------------------------------------|----------------|----------------------------|
| FPM             | [Final Project Milestone #1](assignments/FPM1.qmd)  | Wed 01/07/2026 | Wed 01/21/2026, 11:59pm PT |
| HW              | [Homework #2](assignments/HW2.qmd)                  | Wed 01/21/2026 | Wed 01/28/2026, 11:59pm PT |
: {.hover .bordered tbl-colwidths="[20,30,20,30]"}

