<!DOCTYPE html>
<html lang="en"><head>
<link href="../../images/EDS240-hex.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <title>EDS 240 – slides-amounts-rankings</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../../site_libs/countdown-0.4.0/countdown.css" rel="stylesheet">
  <script src="../../site_libs/countdown-0.4.0/countdown.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="title-slide" class="slide level2 center" data-menu-title="Title Slide" data-background="#053660">
<h2></h2>
<p><span class="custom-title">EDS 240: Lecture 3.1</span></p>
<p><span class="custom-subtitle"><em>Visualizing amounts / rankings</em></span></p>
<hr class="hr-teal">
<p><span class="custom-subtitle3">Week 3 | January 21<sup>st</sup>, 2026</span></p>
</section>
<section id="data-ranking" class="slide level2" data-menu-title="Data amounts / rankings">
<h2></h2>
<p><span class="slide-title">Visualizing data <em>amounts / rankings</em>?</span></p>
<hr>
<p><br> <br></p>
<p><span class="body-text-m">Showing the relationship between a <strong>numeric and categorical variable(s)</strong>, i.e.&nbsp;comparing categorical groups based on their numeric values.</span></p>
<p><br></p>

<img data-src="SLIDES-amounts-rankings_files/figure-revealjs/example-bar-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="roadmap" class="slide level2" data-menu-title="Roadmap">
<h2></h2>
<p><span class="slide-title">Roadmap</span></p>
<hr>
<p>We’ll first explore two (highly interchangeable) chart types for visualizing amounts across a categorical variable (great for highlighting rank or hierarchy):</p>
<p><br></p>
<p><span class="body-text-m">1. bar charts</span><br>
<span class="body-text-m">2. lollipop charts</span> (and dot plot variant)</p>
<p><br></p>
<div class="fragment">
<p>We’ll also learn about a couple alternatives, which may be better suited for you data depending on the context, data structure, and narrative you want to tell:</p>
<p><br></p>
<p><span class="body-text-m">3. heat maps</span> (for when you have 2 categorical + 1 numeric variable and / or want to focus on patterns rather than precise amounts)</p>
<p><span class="body-text-m">4. dumbbell charts</span> (for visualizing change / difference between two groups)</p>
</div>
</section>
<section id="water-use-data" class="slide level2" data-menu-title="About the data">
<h2></h2>
<p><span class="slide-title3">The data: USGS National Water Availability Assessment</span></p>
<hr>
<p><span class="body-text-s">In January 2025, The <a href="https://www.usgs.gov/" target="_blank">U.S. Geological Survey</a> (USGS) released its new <a href="https://www.usgs.gov/special-topics/integrated-water-availability-assessments/science/integrated-water-availability-0" target="_blank">National Water Availability Assessment</a> (NWAA), which offers insights into water <a href="https://water.usgs.gov/nwaa-data/data/integrated-water-availability/iwa-assessment-outputs-conus-2025/availab/availab_iwa-assessment-outputs-conus-2025_README.html" target="_blank">supply</a>, <a href="https://water.usgs.gov/nwaa-data/data/integrated-water-availability/iwa-assessment-outputs-conus-2025/consum/consum_iwa-assessment-outputs-conus-2025_README.html" target="_blank">demand</a>, and quality across the U.S. The modeled water availability data that underlies the NWAA is made available through the online <a href="https://www.usgs.gov/special-topics/integrated-water-availability-assessments/national-water-availability-assessment-0" target="_blank">National Water Availability Assessment Data Companion</a> (NWDC). Here, users can interactively <a href="https://water.usgs.gov/nwaa-data/subset-download" target="_blank">subset and download data</a> or download files containing the <a href="https://water.usgs.gov/nwaa-data/data-file-directory?path=data/" target="_blank">full spatial (conterminous US) and temporal (2010-2020) extent</a> of the NWDC datasets.</span></p>

<img data-src="../images/lecture-slides/NWAA-map.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><div class="center-text body-text-s gray-text">
<p>Surface water-supply and use index (SUI) by 12-digit hydrologic unit codes (HUCs) for water years 2010-2020. Source: <a href="https://pubs.usgs.gov/pp/1894/f/pp1894F.pdf" target="_blank">Chapter F</a> of the U.S. Geological Survey Integrated Water Availability Assessment—2010–20.</p>
</div>
<aside class="notes">
<p>The NWDC provides regularly updated, model-based estimates of water availability and use, derived from USGS scientific models</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="HUCs" class="slide level2" data-menu-title="Understanding HUCs">
<h2></h2>
<p><span class="slide-title3">The data: USGS National Water Availability Assessment</span></p>
<hr>
<p>For today’s lecture, we’ll download the <a href="https://water.usgs.gov/nwaa-data/data-file-directory?path=data/integrated-water-availability/iwa-assessment-outputs-conus-2025/" target="_blank">full, integrated dataset</a> and filter for just the <a href="https://en.wikipedia.org/wiki/California_water_resource_region#:~:text=Article,California%2C%20Nevada%2C%20and%20Oregon." target="_bank">California water resource region</a>, which is represented by the 2-digit hydrologic unit code (HUC), 18. We’ll explore water availability and use across HUC 18’s <a href="https://en.wikipedia.org/wiki/California_water_resource_region#:~:text=%5B3%5D-,List%20of%20California%20water%20resource%20subregions,-%5Bedit%5D" target="_blank">ten subregions</a>.</p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/HUCs-explained.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/HUC18-subregions.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><br></p>
<div class="footer">
<p><strong>(Left)</strong> Source: <a href="https://nas.er.usgs.gov/hucs.aspx" target="_blank">Hydrologic Unit Codes (HUCs) Explained</a>; Hydrologic units are identified using 12-digit hydrologic unit codes (HUC12s), which can be parsed into shorter codes representing larger spatial units (e.g.&nbsp;regions, subregions, subbasins). | <strong>(Right)</strong> California region (HUC 18), with its ten 4-digit subregion hydrologic unit boundaries. Source: <a href="https://en.wikipedia.org/wiki/California_water_resource_region#:~:text=%5B3%5D-,List%20of%20California%20water%20resource%20subregions,-%5Bedit%5D" target="_blank">Wikipedia</a></p>
</div>
</section>
<section id="data-wrangling" class="slide level2" data-menu-title="Data wrangling">
<h2></h2>
<p><span class="slide-title">Data wrangling</span></p>
<hr>
<p><span class="body-text-s">This integrated dataset includes modeled monthly estimates of <a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/availab" target="_blank">available water supply</a>, <a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/consum" target="_blank">water consumption</a>, and the <a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/sui" target="_blank">Surface Water-Supply and Use Index (SUI)</a> for hydrologic units across the conterminous US from 2010-2020.</span></p>
<!-- RUNS BUT DOES NOT PRINT -->
<!-- PRINTS BUT DOES NOT RUN -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-2"><a></a><span class="do">##                                    setup                                 ----</span></span>
<span id="cb1-3"><a></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="co">#..........................load packages.........................</span></span>
<span id="cb1-6"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-8"><a></a><span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a></a></span>
<span id="cb1-10"><a></a><span class="co">#..........................import data...........................</span></span>
<span id="cb1-11"><a></a>iwa_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"week3"</span>, <span class="st">"data"</span>, <span class="st">"combined_iwa-assessment-outputs-conus-2025_CONUS_200910-202009_long.csv"</span>))</span>
<span id="cb1-12"><a></a></span>
<span id="cb1-13"><a></a><span class="co">#..................create df of subregions names.................</span></span>
<span id="cb1-14"><a></a><span class="co"># data only contain HUC codes; must manually join names if we want to include those in our viz (which we do! we'll mainly be looking at CA subregions)</span></span>
<span id="cb1-15"><a></a><span class="co"># subregions (&amp; others) identified in: https://water.usgs.gov/GIS/wbd_huc8.pdf</span></span>
<span id="cb1-16"><a></a><span class="co"># there may be a downloadable dataset containing HUCs &amp; names out there...but I couldn't find it</span></span>
<span id="cb1-17"><a></a>subregion_names <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1-18"><a></a>  <span class="sc">~</span>subregion_HUC, <span class="sc">~</span>subregion_name,</span>
<span id="cb1-19"><a></a>  <span class="st">"1801"</span>, <span class="st">"Klamath-Northern California Coastal"</span>,</span>
<span id="cb1-20"><a></a>  <span class="st">"1802"</span>, <span class="st">"Sacramento"</span>,</span>
<span id="cb1-21"><a></a>  <span class="st">"1803"</span>, <span class="st">"Tulare-Buena Vista Lakes"</span>,</span>
<span id="cb1-22"><a></a>  <span class="st">"1804"</span>, <span class="st">"San Joaquin"</span>,</span>
<span id="cb1-23"><a></a>  <span class="st">"1805"</span>, <span class="st">"San Francisco Bay"</span>,</span>
<span id="cb1-24"><a></a>  <span class="st">"1806"</span>, <span class="st">"Central California Coastal"</span>,</span>
<span id="cb1-25"><a></a>  <span class="st">"1807"</span>, <span class="st">"Southern California Coastal"</span>,</span>
<span id="cb1-26"><a></a>  <span class="st">"1808"</span>, <span class="st">"North Lahontan"</span>, </span>
<span id="cb1-27"><a></a>  <span class="st">"1809"</span>, <span class="st">"Northern Mojave-Mono Lake"</span>,</span>
<span id="cb1-28"><a></a>  <span class="st">"1810"</span>, <span class="st">"Southern Mojave-Salton Sea"</span>,</span>
<span id="cb1-29"><a></a>)</span>
<span id="cb1-30"><a></a></span>
<span id="cb1-31"><a></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-32"><a></a><span class="do">##                                wrangle data                              ----</span></span>
<span id="cb1-33"><a></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-34"><a></a></span>
<span id="cb1-35"><a></a><span class="co">#......create df with just CA water resource region (HUC 18).....</span></span>
<span id="cb1-36"><a></a>ca_region <span class="ot">&lt;-</span> iwa_data <span class="sc">|&gt;</span> </span>
<span id="cb1-37"><a></a></span>
<span id="cb1-38"><a></a>  <span class="co"># make nicer column names ----</span></span>
<span id="cb1-39"><a></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb1-40"><a></a></span>
<span id="cb1-41"><a></a>  <span class="co"># create columns for 2-unit (region-level) &amp; 4-unit (subregion-level) HUC using full 12-unit HUC ----</span></span>
<span id="cb1-42"><a></a>  <span class="fu">mutate</span>(<span class="at">region_HUC =</span> <span class="fu">str_sub</span>(<span class="at">string =</span> huc12_id, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">2</span>),</span>
<span id="cb1-43"><a></a>         <span class="at">subregion_HUC =</span> <span class="fu">str_sub</span>(<span class="at">string =</span> huc12_id, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-44"><a></a>  </span>
<span id="cb1-45"><a></a>  <span class="co"># filter for just CA region (HUC 18) ----</span></span>
<span id="cb1-46"><a></a>  <span class="fu">filter</span>(region_HUC <span class="sc">==</span> <span class="st">"18"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-47"><a></a></span>
<span id="cb1-48"><a></a>  <span class="co"># separate year and month into two columns ----</span></span>
<span id="cb1-49"><a></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> year_month,</span>
<span id="cb1-50"><a></a>                       <span class="at">delim =</span> <span class="st">"-"</span>,</span>
<span id="cb1-51"><a></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-52"><a></a></span>
<span id="cb1-53"><a></a>  <span class="co"># convert year and month from chr to num ---                            </span></span>
<span id="cb1-54"><a></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year),</span>
<span id="cb1-55"><a></a>         <span class="at">month =</span> <span class="fu">as.numeric</span>(month)) <span class="sc">|&gt;</span> </span>
<span id="cb1-56"><a></a>  </span>
<span id="cb1-57"><a></a>  <span class="co"># join subregion names ----</span></span>
<span id="cb1-58"><a></a>  <span class="fu">left_join</span>(subregion_names) <span class="sc">|&gt;</span> </span>
<span id="cb1-59"><a></a>  </span>
<span id="cb1-60"><a></a>  <span class="co"># keep necessary columns &amp; reorder in more logical way -----</span></span>
<span id="cb1-61"><a></a>  <span class="fu">select</span>(year, month, huc12_id, region_HUC, subregion_HUC, subregion_name, availab_mm_mo, consum_mm_mo, sui_frac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>“In equation-form: Total water availability = net water delivered to next downstream HUC12 (baseflow + quickflow + upstream inputs) - total consumptive loss. In some cases, total water availability can be negative, implying that consumptive losses are greater than natural supply. This situation can occur when human water consumption is sustained through deep groundwater sources, transbasin diversion, or drawdown of local storage.” https://water.usgs.gov/nwaa-data/data/integrated-water-availability/iwa-assessment-outputs-conus-2025/availab/availab_iwa-assessment-outputs-conus-2025_README.html#:~:text=Technical%20Description:,or%20drawdown%20of%20local%20storage.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="bar-lollipop" class="slide level2" data-menu-title="## Bar &amp; lollipop ##" data-background="#047C90">
<h2></h2>
<div class="vertical-center">
<center>
<div class="custom-subtitle">
Bar charts &amp; lollipop charts
</div>
</center>
<center>
<div class="custom-subtitle3">
<em>interchangeable | focus is on highest and lowest values (as well as overall rank / hierarchy) | best for visualizing amounts across a single categorical variable | encode values using LENGTH</em>
</div>
</center>
</div>
</section>
<section id="bar-lolli-1group" class="slide level2" data-menu-title="Bar &amp; Lollipop plots (1 group)">
<h2></h2>
<p><span class="slide-title">Bar &amp; lollipop plots to visualize rankings</span></p>
<hr>
<p><span class="body-text-s">Let’s first look at the <strong>long-term mean Surface Water-Supply and Use Index (SUI) across the ten HUC 18 subregions</strong>. Higher SUI values indicate greater water stress. Each bar and lollipop represents the mean SUI for a given subregion, calculated by averaging all monthly SUI values from 2010–2020.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> subregion_name, <span class="at">y =</span> mean_sui_2010_2020)) <span class="sc">+</span></span>
<span id="cb2-5"><a></a>  <span class="fu">geom_col</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/basic-bar-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> subregion_name, <span class="at">y =</span> mean_sui_2010_2020)) <span class="sc">+</span></span>
<span id="cb3-5"><a></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> mean_sui_2010_2020))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/basic-lollipop-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="footer">
<p>From the <a href="https://water.usgs.gov/vizlab/water-availability/glossary" target="_blank">USGS Glossary</a>: <em>“A high index value indicates that a high proportion of the average supply is either consumed by human use or unavailable because of climatic variation, leading to high water stress.”</em></p>
</div>
<aside class="notes">
<p>You might also consider using <code>ggalt::geom_lollipop()</code> for a simple lollipop chart, though you may run into limitations when creating more complex charts.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="coord-flip-theme" class="slide level2" data-menu-title="Flip axes / update label angle">
<h2></h2>
<p><span class="slide-title">Make space for long x-axis labels</span></p>
<hr>
<p><span class="body-text-s">We never want to leave overlapping or super squished text (especially axis text) on our plots. Let’s give those long x-axis labels some breathing room using by reversing your axes mappings! Alternatively, you can leave your mappings as-is and apply <code>coord_flip()</code>.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb4-5"><a></a>  <span class="fu">geom_col</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/flipped-bar-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="4,6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb5-5"><a></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> mean_sui_2010_2020))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/flipped-lollipop-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="footer">
<p>We also want to avoid the temptation to <a href="https://clauswilke.com/dataviz/visualizing-amounts.html" target="_blank">rotate our axis text</a> (or any text, for that matter). Rotated text forces readers to tilt their heads or strain their eyes to read labels. Flipping the axes is almost always a better, more readable alternative.</p>
</div>
</section>
<section id="arrange-bars" class="slide level2" data-menu-title="Arrange bars">
<h2></h2>
<p><span class="slide-title3">Reordering groups helps readers more quickly derive insight</span></p>
<hr>
<p><span class="body-text-s">Here, we use <code>forcats::fct_reorder()</code> to reorder the levels of our y-axis variable, <code>name</code>, based on a numeric variable, <code>mean_sui_2010_2020</code>.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a></a>  <span class="fu">mutate</span>(<span class="at">subregion_name =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> subregion_name, <span class="at">.x =</span> mean_sui_2010_2020)) <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb6-6"><a></a>  <span class="fu">geom_col</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/ordered-bars-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a></a>  <span class="fu">mutate</span>(<span class="at">subregion_name =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> subregion_name, <span class="at">.x =</span> mean_sui_2010_2020)) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb7-6"><a></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> mean_sui_2010_2020))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/ordered-lollipops-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="footer">
<p>Check out <a href="https://blog.albertkuo.me/post/2022-01-04-reordering-geom-col-and-geom-bar-by-count-or-value/" target="_blank">this blog post</a> for more useful reordering approaches / examples.</p>
</div>
</section>
<section id="add-labels" class="slide level2" data-menu-title="Add labels">
<h2></h2>
<p><span class="slide-title2">Add direct labels if the exact values are important</span></p>
<hr>
<p><span class="body-text-s"><code>geom_text()</code> allows us to map values from a column (here, <code>mean_sui_2010_2020</code>) directly onto the plot as text labels. This can be helpful if it’s important for readers to know precise values. Avoid adding if relative comparisons are enough or if it’s easy to estimate the length of a bar against its axis.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a></a>  <span class="fu">mutate</span>(<span class="at">subregion_name =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> subregion_name, <span class="at">.x =</span> mean_sui_2010_2020)) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb8-6"><a></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb8-7"><a></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_sui_2010_2020, <span class="dv">2</span>)), <span class="at">hjust =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"white"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/labeled-bar-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="8,9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a></a>  <span class="fu">mutate</span>(<span class="at">subregion_name =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> subregion_name, <span class="at">.x =</span> mean_sui_2010_2020)) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb9-6"><a></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-7"><a></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> mean_sui_2010_2020)) <span class="sc">+</span></span>
<span id="cb9-8"><a></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_sui_2010_2020, <span class="dv">2</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb9-9"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/labeled-lollipop-1.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<!-- ::: {.footer}
For some more advanced label manipulation, see [A Quick How-to on Labelling Bar Graphs in ggplot2](https://www.cedricscherer.com/2021/07/05/a-quick-how-to-on-labelling-bar-graphs-in-ggplot2/){target="_blank"}, by Cédric Scherer 
::: -->
</section>
<section id="col-vs-bar" class="slide level2" data-menu-title="geom_col() vs. geom_bar()">
<h2></h2>
<p><span class="slide-title2">An aside: <code>geom_col()</code> vs.&nbsp;<code>geom_bar()</code></span></p>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="body-text-s"><strong>Use <code>geom_col()</code> when you want the heights of your bars to represent values in your data</strong> (i.e.&nbsp;you have a variable in your data set that maps to the length (or height) of your bars). Here, we already have a numeric variable in our data set called, <code>mean_sui_2010_2020</code>, which is mapped to the length of each bar in our plot:</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>ca_region <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a></a>  <span class="fu">group_by</span>(subregion_name) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_sui_2010_2020 =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_sui_2010_2020, <span class="at">y =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb10-5"><a></a>  <span class="fu">geom_col</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/geom_col-comp-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="body-text-s"><strong>Use <code>geom_bar()</code> if you want the heights of your bars to be proportional to the number of cases in each group.</strong> E.g. if we want to know how many observations exist for each subregion (note that we don’t have a <code>count</code> column in our data frame – <code>geom_bar()</code> groups by <code>subregion_name</code> then counts the number of observations for each <code>subregion_name</code> group):</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">ggplot</span>(ca_region, <span class="fu">aes</span>(<span class="at">x =</span> subregion_name)) <span class="sc">+</span></span>
<span id="cb11-2"><a></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">label_comma</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/geom-bar-comp-1.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="footer">
<p>Each of our subregions have a different number of subwatersheds (represented by HUC12 IDs), which is why we have a different number of rows (observations) for each</p>
</div>
</section>
<section id="truncated-axis" class="slide level2" data-menu-title="Truncated axis">
<h2></h2>
<p><span class="slide-title2">IMPORTANT: Do not truncate axes</span></p>
<hr>
<div class="center-text body-text-m">
<p>Because bar (and related) charts <strong>encode values by length from zero</strong>, cutting the axis exaggerates differences and is misleading. The axis <strong>must</strong> start at zero.</p>
</div>
<p><span class="body-text-s">Truncated axes leads viewers to perceive illustrated differences as larger or more important than they actually are (i.e.&nbsp;a truncation effect). <a href="https://doi.org/10.1016/j.jarmac.2020.10.002" target="_blank">Yang et al.&nbsp;(2021)</a> empirically tested this effect and found that this truncation effect persisted even after viewers were taught about the effects of y-axis truncation.</span></p>
<p><br></p>

<img data-src="../images/lecture-slides/yang-etal-2021.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"><div class="center-text gray-text body-text-s">
<p>Figure 2 from Yang et al.&nbsp;2021. The left-most plot without a truncated y-axis was presented to the control group of viewers. The right-most plot with a truncated y-axis was presented to the test group of viewers.</p>
</div>
<p><br></p>
<div class="footer">
<p>Yang et al.&nbsp;(2021) Truncating bar graphs persistently misleads viewers. <em>Journal of Applied Research in Memory and Cognition</em> 10:2, 298-311. <a href="https://doi.org/10.1016/j.jarmac.2020.10.002" target="_blank">https://doi.org/10.1016/j.jarmac.2020.10.002</a></p>
</div>
</section>
<section id="dot-plot" class="slide level2" data-menu-title="Dot plots ">
<h2></h2>
<p><span class="slide-title">But you can cut the y-axis of dot plots!</span></p>
<hr>
<div class="center-text body-text-m">
<p>Because dot plots <strong>encode values by position</strong>, truncating the axis doesn’t distort comparisons. The axis <strong>does not have to</strong> start at zero.</p>
</div>
<p><span class="body-text-s">When bars are all long and have nearly the same length, the eye is drawn to the middle of the bars rather than to their end points. A lollipop plot is a bit less distracting (less ink), but still difficult to differentiate risk scores across counties. When we limit the axis range in a dot plot, it becomes easier to identify differences in the max and min values.</span></p>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/nj-bar.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/nj-lollipop.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/nj-dot.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><br></p>
<div class="footer">
<p>Create a dot plot using <code>geom_point()</code>, then adjust <code>panel.grid</code> lines inside <code>theme()</code> | You’ll see these county-level <a href="https://www.fema.gov/flood-maps/products-tools/national-risk-index" target="_blank">FEMA National Risk Index</a> scores in <a href="https://eds-240-data-viz.github.io/course-materials/assignments/HW2.html" target="_blank">Homework #2</a>!</p>
</div>
<aside class="notes">
<ul>
<li>Bar charts are like measuring heights of people from the ground—you need the ground (zero) as reference</li>
<li>Dot plots are like plotting temperature over time—you care about the differences and trends, not the distance from absolute zero</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="cat-not-cont" class="slide level2" data-menu-title="Bar plots for categorical data">
<h2></h2>
<p><span class="slide-title3">Be cautious when using bar plots to summarize continuous data</span></p>
<hr>
<p><span class="body-text-s"><strong>Bar plots shine when you need to compare counts</strong> (e.g.&nbsp;populations size of different countries). <em>However</em>, you should proceed with caution when using bar plots to visualize the distribution of / summarize your data. Doing so can be <em>misleading</em>, particularly when you have small sample sizes. Why?</span></p>
<div class="fragment">
<ul>
<li><p><span class="body-text-s">bar plots hide the distribution of the underlying data (many different distributions can lead to the same plot)</span></p></li>
<li><p><span class="body-text-s">when used this way, the height of the bar (typically) represents the mean of the data, which can cause readers to incorrectly infer that the data are normally distributed with no outliers (this of course <em>may</em> be true in some cases, but certainly not always)</span></p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/weissgerber-etal-2015.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/horst-barplot.png" class="quarto-figure quarto-figure-center" style="width:70.0%" alt="Main text: 'Are your summary statistics hiding something?' On the left is a opaque gray bar plot with an error bar, looking mischievous while hiding individual data points in a net behind it. On the right is a transparent bar plot with an error bar, looking exposed, with individual data points exposed and dancing. The bottom four data points have arms that spell 'YMCA' as if dancing to the Village People."></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><br></p>
<div class="footer">
<p><strong>Left:</strong> <a href="https://journals.plos.org/plosbiology/article?id=10.1371%2Fjournal.pbio.1002128#pbio-1002128-g001" target="_blank">Figure 1</a> from Weissgerber et al.&nbsp;(2015) Beyond Bar and Line Graphs: Time for a New Data Presentation Paradigm. <em>PLOS Biology</em> 13:e1002128. <a href="https://doi.org/10.1371/journal.pbio.1002128" target="_blank">https://doi.org/10.1371/journal.pbio.1002128</a> | <strong>Right:</strong> Artwork by <a href="https://allisonhorst.com/" target="_blank">Allison Horst</a></p>
</div>
<aside class="notes">
<ul>
<li><p>It’s okay to use bar (or related) plots anytime you’re comparing counts (e.g.&nbsp;population size of different countries, total earnings by group) — this is really where bar plots shine! If you are using a bar plot to visualize the distribution/summarize of your data, you should consider if there are better alternative options (e.g.&nbsp;box plots) — if you are inclined to include some sort of error bar / standard deviation on your bar plot, you are likely attempting to use your bar plot to visualize a distribution. Why is this wrong?</p></li>
<li><p>It’s not necessarily wrong, but it can be misleading, particularly when dealing with small sample sizes because (1) it’s impossible to know the distribution of the underlying data, and many different data distributions can lead to the same bar plot (see figure on lecture 4.1 slide 15). (2) When used this way, the height of the bar (typically) represents the mean of the data, which can cause readers to incorrectly infer that the data are normally distributed with no outliers (this of course may be true in certain cases, but certainly is not always true…particularly when dealing with small sample sizes where outliers are common)</p></li>
</ul>
<p>Bar plots are very commonly used in both ways (comparing counts and visualizing distributions) — for example, see <a href="https://www.labxchange.org/library/items/lb:LabXchange:e034541a:html:1">this online resource</a> that reviews how to interpret both forms of a bar plot. However, you should proceed with extreme caution when using bar plots to summarize your data for the reasons outlined above. If you do choose to use a bar plot, consider layering on the raw data points as well (this isn’t always feasible with larger data sets).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="stacked-bar-chart" class="slide level2" data-menu-title="## Stacked Bar ##" data-background="#047C90">
<h2></h2>
<div class="vertical-center">
<center>
<div class="custom-subtitle">
Stacked bar charts
</div>
</center>
<center>
<div class="custom-subtitle3">
<em>great for part-to-whole comparisons | use a percentage stacked bar chart when you want the focus to be on relative proportions | encode values using LENGTH</em>
</div>
</center>
</div>
</section>
<section id="stacked-bar" class="slide level2" data-menu-title="Stacked bar plot">
<h2></h2>
<p><span class="slide-title2">Stacked bar plots for showing parts of a whole</span></p>
<hr>
<p><span class="body-text-s">The USGS classifies <strong><a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/sui" target="_blank">SUI</a></strong> into five categories: <em>Very low (0.0 to &lt;0.2), Low (0.2 to &lt;0.4), Moderate (0.4 to &lt;0.6), High (0.6 to &lt;0.8), and Severe (0.8 to 1)</em>. <strong>Let’s say we want to look at how California subwatersheds (HUC12s) are distributed across these categories by month from 2010–2020.</strong> We can use a stacked bar plot, each bar represents a month and segments represent the number of subwatersheds in each SUI category. Let’s first do a bit of wrangling:</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/stacked-bar-ex.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>sui_severity <span class="ot">&lt;-</span> ca_region <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a></a>    <span class="at">sui_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-4"><a></a>      sui_frac <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Very low"</span>,</span>
<span id="cb12-5"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb12-6"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb12-7"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb12-8"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Severe"</span>,</span>
<span id="cb12-9"><a></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb12-10"><a></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a></a>  <span class="fu">group_by</span>(month, sui_category) <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a></a>  <span class="fu">summarize</span>(<span class="at">tot_num_sui =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a></a>  <span class="fu">drop_na</span>(sui_category) <span class="sc">|&gt;</span> </span>
<span id="cb12-14"><a></a>  <span class="fu">mutate</span>(<span class="at">month =</span> month.abb[month],</span>
<span id="cb12-15"><a></a>         <span class="at">month =</span> <span class="fu">factor</span>(month, <span class="at">levels =</span> <span class="fu">c</span>(month.abb[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>], month.abb[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]))) <span class="co"># order months Oct &gt; Sep (water year)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_b06c5aef" data-update-every="1" data-play-sound="true" tabindex="0" style="right:0;bottom:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>
<div class="footer">
<p>Image source: <a href="https://datavizproject.com/data-type/stacked-bar-chart/" target="_blank">Data Viz Project</a>. <strong>Take a few minutes to run and understand this wrangling code with your learning partners. Note any questions you have.</strong></p>
</div>
</section>
<section id="stacked-bar-improvements" class="slide level2" data-menu-title="Stacked bar plot improvements?">
<h2></h2>
<p><span class="slide-title">What improvements should we make?</span></p>
<hr>
<p><span class="body-text-s">The code for a stacked bar plot is not so different from a standard bar plot – just add a categorical variable as your <code>fill</code>:</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">ggplot</span>(sui_severity, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> tot_num_sui, <span class="at">fill =</span> sui_category)) <span class="sc">+</span></span>
<span id="cb13-2"><a></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SLIDES-amounts-rankings_files/figure-revealjs/improvements-needed-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><div class="fragment">
<p><span class="body-text-s">To make interpretation easier, we should (1) <strong>reorder</strong> <code>sui_category</code> so that they’re in a logical order and that the most important (<code>Severe</code>) is on the bottom (making it easier to read against the y-axis; we should update our legend order to reflect this as well), (2) convert our y-axis values to <strong>percentages</strong>, and (3) update our <strong>colors</strong> (we can adopt those used by USGS – see <a href="../../course-materials/lecture-slides/SLIDES-amounts-rankings.html#water-use-data" target="_blank">this slide</a>)</span></p>
</div>
</section>
<section id="revise-wrangling-update-df" class="slide level2" data-menu-title="Revise wrangling 2">
<h2></h2>
<p><span class="slide-title">Let’s first update our wrangling code</span></p>
<hr>
<p>Reorder the <code>sui_category</code> groups from “Very low” &gt; “Severe”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-code-line-numbers="16-18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>sui_severity <span class="ot">&lt;-</span> ca_region <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-3"><a></a>    <span class="at">sui_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-4"><a></a>      sui_frac <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Very low"</span>,</span>
<span id="cb14-5"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb14-6"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb14-7"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb14-8"><a></a>      sui_frac <span class="sc">&gt;=</span> <span class="fl">0.8</span> <span class="sc">&amp;</span> sui_frac <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Severe"</span>,</span>
<span id="cb14-9"><a></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb14-10"><a></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb14-11"><a></a>  <span class="fu">group_by</span>(month, sui_category) <span class="sc">|&gt;</span> </span>
<span id="cb14-12"><a></a>  <span class="fu">summarize</span>(<span class="at">tot_num_sui =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb14-13"><a></a>  <span class="fu">drop_na</span>(sui_category) <span class="sc">|&gt;</span> </span>
<span id="cb14-14"><a></a>  <span class="fu">mutate</span>(<span class="at">month =</span> month.abb[month],</span>
<span id="cb14-15"><a></a>         <span class="at">month =</span> <span class="fu">factor</span>(month, <span class="at">levels =</span> <span class="fu">c</span>(month.abb[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>], month.abb[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]))) <span class="sc">|&gt;</span> </span>
<span id="cb14-16"><a></a>  <span class="fu">mutate</span>(<span class="at">sui_category =</span> <span class="fu">factor</span>(sui_category, <span class="co"># reorder categories</span></span>
<span id="cb14-17"><a></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Very low"</span>, <span class="st">"Low"</span>,</span>
<span id="cb14-18"><a></a>                                          <span class="st">"Moderate"</span>, <span class="st">"High"</span>, <span class="st">"Severe"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="percentage-stacked-bar" class="slide level2" data-menu-title="Create percentage stacked bar chart">
<h2></h2>
<p><span class="slide-title2">Then, convert to percentage stacked bar chart</span></p>
<hr>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co">#......................create color palette......................</span></span>
<span id="cb15-2"><a></a><span class="co"># pulled hex codes from USGS map using ColorZilla Chrome extension</span></span>
<span id="cb15-3"><a></a>sui_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Severe"</span> <span class="ot">=</span> <span class="st">"#720C0F"</span>, </span>
<span id="cb15-4"><a></a>                <span class="st">"High"</span> <span class="ot">=</span> <span class="st">"#F68939"</span>, </span>
<span id="cb15-5"><a></a>                <span class="st">"Moderate"</span> <span class="ot">=</span> <span class="st">"#FBF7BF"</span>, </span>
<span id="cb15-6"><a></a>                <span class="st">"Low"</span> <span class="ot">=</span> <span class="st">"#AAD9EA"</span>, </span>
<span id="cb15-7"><a></a>                <span class="st">"Very low"</span> <span class="ot">=</span> <span class="st">"#217AB5"</span>)</span>
<span id="cb15-8"><a></a></span>
<span id="cb15-9"><a></a><span class="co">#...................create % stacked bar chart...................</span></span>
<span id="cb15-10"><a></a><span class="fu">ggplot</span>(sui_severity, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> tot_num_sui, <span class="at">fill =</span> sui_category)) <span class="sc">+</span></span>
<span id="cb15-11"><a></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sui_colors) <span class="sc">+</span></span>
<span id="cb15-13"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">100</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="SLIDES-amounts-rankings_files/figure-revealjs/percentage-stacked-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><div class="footer">
<p>Inspiration for this viz came directly from the <a href="https://pubs.usgs.gov/pp/1894/f/pp1894F.pdf" target="_blank">U.S. Geological Survey Integrated Water Availability Assessment—2010–20 (Ch. F)</a> (see page 9) | The <a href="https://scales.r-lib.org/" target="_blank"><code>{scales}</code> package</a> is a true label-editing hero! Keep this one in mind whenever you need to reformat axis labels.</p>
</div>
</section>
<section id="heatmaps" class="slide level2" data-menu-title="## Heatmaps ##" data-background="#047C90">
<h2></h2>
<div class="vertical-center">
<center>
<div class="custom-subtitle">
Heatmaps
</div>
</center>
<center>
<div class="custom-subtitle3">
<em>great option for visualizing matrices of data (e.g.&nbsp;2 categorical + 1 numeric variable) | focus is on patterns rather than precise amounts | consider audience familiarity (may require more explanation than a bar plot) | encode values using COLOR</em>
</div>
</center>
</div>
</section>
<section id="heatmap-example" class="slide level2" data-menu-title="Heatmap (example)">
<h2></h2>
<p><span class="slide-title2">Heatmap for 2 categorical + 1 numeric variable</span></p>
<hr>
<p><span class="body-text-s">Now let’s look at <strong>how water stress changes through time for each of the ten HUC 18 subregions</strong>. We can use a heatmap to create a matrix that displays annual mean SUI values (numeric, continuous), calculated by averaging monthly observations within each year, by subregion (categorical) and year (categorical). We need to do a bit of wrangling:</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/heatmap-example.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="body-text-s gray-text center-text">
<p>Image source: <a href="https://datavizproject.com/data-type/heat-map/" target="_&quot;blank&quot;">Data Viz Project</a>.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="co">#...........df of annual mean SUI by subregion &amp; year ...........</span></span>
<span id="cb16-2"><a></a>heatmap_data <span class="ot">&lt;-</span> ca_region <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a></a>  <span class="fu">group_by</span>(subregion_name, year) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a></a>  <span class="fu">summarize</span>(<span class="at">annual_mean_sui =</span> <span class="fu">mean</span>(sui_frac, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a></a>  <span class="fu">ungroup</span>()</span>
<span id="cb16-6"><a></a></span>
<span id="cb16-7"><a></a><span class="co">#.determine order of subregions based on highest avg SUI in 2015.</span></span>
<span id="cb16-8"><a></a><span class="co"># it's likely that you'll first try making a plot with `heatmap_data`, then return to wrangle the order once you decide how best to arrange your groups</span></span>
<span id="cb16-9"><a></a>order_2015 <span class="ot">&lt;-</span> heatmap_data <span class="sc">|&gt;</span> </span>
<span id="cb16-10"><a></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-11"><a></a>  <span class="fu">arrange</span>(annual_mean_sui) <span class="sc">|&gt;</span> </span>
<span id="cb16-12"><a></a>  <span class="fu">mutate</span>(<span class="at">order =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb16-13"><a></a>  <span class="fu">select</span>(subregion_name, order) </span>
<span id="cb16-14"><a></a></span>
<span id="cb16-15"><a></a><span class="co">#........join order with rest of data to set factor levels.......</span></span>
<span id="cb16-16"><a></a>heatmap_order <span class="ot">&lt;-</span> heatmap_data <span class="sc">|&gt;</span> </span>
<span id="cb16-17"><a></a>  <span class="fu">left_join</span>(order_2015) <span class="sc">|&gt;</span> </span>
<span id="cb16-18"><a></a>  <span class="fu">mutate</span>(<span class="at">subregion_name =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> subregion_name, <span class="at">.x =</span> order))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="heatmap-plot" class="slide level2" data-menu-title="Heatmap (plot)">
<h2></h2>
<p><span class="slide-title2">Heatmap for 2 categorical + 1 numeric variable</span></p>
<hr>
<p><span class="body-text-s">How you order your groups can (1) make it easier for readers to extract patterns and comparisons, and (2) shape the story the visualization tells. Here, subregions are ordered based on their average annual SUI in 2015, the end of a particularly dry stretch of years. <strong><em>How else might you consider ordering these groups?</em></strong></span></p>
<p><br></p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/heatmap-plot-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">ggplot</span>(heatmap_order, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> subregion_name, <span class="at">fill =</span> annual_mean_sui)) <span class="sc">+</span></span>
<span id="cb17-2"><a></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Annual Mean Surface Water-Supply and</span><span class="sc">\n</span><span class="st">Use Index (SUI)"</span>) <span class="sc">+</span> <span class="co"># caption = "A higher index value indicates greater water stress."</span></span>
<span id="cb17-4"><a></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2010</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> <span class="dv">15</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>, <span class="at">title.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb17-7"><a></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a></a>  <span class="fu">theme</span>(</span>
<span id="cb17-9"><a></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb17-10"><a></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-11"><a></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-12"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="dumbbell-plots" class="slide level2" data-menu-title="## Dumbbell plots ##" data-background="#047C90">
<h2></h2>
<div class="vertical-center">
<center>
<div class="custom-subtitle">
Dumbbell plots
</div>
</center>
<center>
<div class="custom-subtitle3">
<em>highlights magnitude and direction of change (or difference) between two values within a category | shows exact values, but focus is on the difference between values | encode values using POSITION</em>
</div>
</center>
</div>
</section>
<section id="dumbbell-example" class="slide level2" data-menu-title="Dumbbell example">
<h2></h2>
<p><span class="slide-title3">Dumbbell plot for 1 categorical + 2 within-category numeric variables</span></p>
<hr>
<p><span class="body-text-s">Let’s say we want to <strong>compare mean monthly water <a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/availab" target="_blank">availability</a> and <a href="https://water.usgs.gov/nwaa-data/data-catalog/sector/integrated-water-availability/model/iwa-assessment-outputs-conus-2025/variable/consum" target="_blank">consumption</a> in the Santa Barbara Coastal subbasin (HUC8: 18060013) across the years 2010-2020</strong>. We can use a dumbbell (aka Cleveland) plot to display the average amount of water (mm; numeric) available vs.&nbsp;consumed (categorical), by month (categorical).</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/dumbbell-example.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<div class="center-text body-text-s gray-text">
<p>Image source: <a href="https://datavizproject.com/data-type/dumbbell-plot/" target="_blank">Data Viz Project</a></p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/lecture-slides/sbc-subbasin.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="center-text body-text-s gray-text">
<p>Image source: <a href="https://www.countyofsb.org/2555/South-Coast-Groundwater-Basins" target="_blank">County of Santa Barbara Public Works</a></p>
</div>
</div></div>
</section>
<section id="dumbbell-definitions" class="slide level2" data-menu-title="Dumbbell definitions">
<h2></h2>
<p><span class="slide-title3">Dumbbell plot for 1 categorical + 2 within-category numeric variables</span></p>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="body-text-s"><span class="teal-text"><strong><i class="fa-solid fa-droplet" title="water droplet" aria-label="droplet"></i> Total Water Availability (<code>availab_mm_mo</code>)</strong></span> = total amount of water exiting a particular 12-digit hydrologic unit (HUC12), calculated as the net of streamflow inputs minus total consumptive water use locally and upstream; can be negative, implying that consumptive losses &gt; natural supply (in these cases, human consumption is sustained through deep groundwater sources, transbasin diversion, or drawdown of local storage)</span></p></li>
<li><p><span class="body-text-s"><span class="teal-text"><strong><i class="fa-solid fa-faucet-drip" title="dripping faucet" aria-label="faucet-drip"></i> Total Water Consumption (<code>consum_mm_mo</code>)</strong></span> = total amount of water consumed for public supply, thermoelectric power, and crop irrigation; refers to the permanent removal of water from the local environment</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>sbc_subbasin_monthly <span class="ot">&lt;-</span> ca_region <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a></a>  <span class="fu">mutate</span>(<span class="at">subbasin_HUC =</span> <span class="fu">str_sub</span>(<span class="at">string =</span> huc12_id, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a></a>  <span class="fu">filter</span>(subbasin_HUC <span class="sc">==</span> <span class="st">"18060013"</span>) <span class="sc">|&gt;</span> <span class="co">#</span></span>
<span id="cb18-4"><a></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a></a>  <span class="fu">summarize</span>(<span class="at">mean_avail =</span> <span class="fu">mean</span>(availab_mm_mo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-6"><a></a>            <span class="at">mean_consum =</span> <span class="fu">mean</span>(consum_mm_mo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-7"><a></a>  <span class="fu">mutate</span>(<span class="at">month =</span> month.abb[month],</span>
<span id="cb18-8"><a></a>         <span class="at">month =</span> <span class="fu">factor</span>(month, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(month.abb[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>], month.abb[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="dumbbell-plot-example" class="slide level2" data-menu-title="Dumbbell plot - water available vs. consumed (plot)">
<h2></h2>
<p><span class="slide-title3">Dumbbell plot for 1 categorical + 2 within-category numeric variables</span></p>
<hr>
<p><span class="body-text-s">Here, it makes sense to order the y-axis groups chronologically (Oct &gt; Sep). If your grouping variable is not inherently chronological (e.g.&nbsp;if comparing water availability and consumption across different subbasins), a common approach is to order groups by a mean or max value. See this <a href="../../course-materials/lecture-slides/ARCHIVE/SLIDES-amounts-rankings-jobs.html#dumbbell-plot-example" target="_blank">archived version</a> of the lecture for an alternative dumbbell plot example where we order differently.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="SLIDES-amounts-rankings_files/figure-revealjs/dumbbell-plot-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">ggplot</span>(sbc_subbasin_monthly) <span class="sc">+</span></span>
<span id="cb19-2"><a></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">y =</span> month,</span>
<span id="cb19-3"><a></a>                     <span class="at">xmin =</span> mean_consum, <span class="at">xmax =</span> mean_avail)) <span class="sc">+</span> </span>
<span id="cb19-4"><a></a>  <span class="fu">ggeom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_avail, <span class="at">y =</span> month), </span>
<span id="cb19-5"><a></a>             <span class="at">color =</span> <span class="st">"#448F9C"</span>, </span>
<span id="cb19-6"><a></a>             <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb19-7"><a></a>             <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_consum, <span class="at">y =</span> month), </span>
<span id="cb19-9"><a></a>             <span class="at">color =</span> <span class="st">"#9C7344"</span>, </span>
<span id="cb19-10"><a></a>             <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb19-11"><a></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb19-12"><a></a>             <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb19-13"><a></a>             <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean monthly water availability &amp; consumption (mm)"</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
<p><br></p>
<div class="footer">
<p><strong>There are more modifications we would need to make before calling this plot done (e.g.&nbsp;adding a title, legend info, theme) – we’ll come back to this in a later lecture!</strong></p>
</div>
<aside class="notes">
<ul>
<li>Example viz: <a href="https://www.usgs.gov/media/images/water-supply-vs-demand-2010-2020" class="uri">https://www.usgs.gov/media/images/water-supply-vs-demand-2010-2020</a></li>
<li>Availability README: https://water.usgs.gov/nwaa-data/data/integrated-water-availability/iwa-assessment-outputs-conus-2025/availab/availab_iwa-assessment-outputs-conus-2025_README.html</li>
<li>Consumption README: https://water.usgs.gov/nwaa-data/data/integrated-water-availability/iwa-assessment-outputs-conus-2025/consum/consum_iwa-assessment-outputs-conus-2025_README.html</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="end-break" class="slide level2" data-menu-title="# Break #" data-background="#047C90">
<h2></h2>
<div class="page-center vertical-center">
<p class="custom-subtitle bottombr">
<i class="fa-solid fa-mug-hot" title="a mug with steam rising out the top" aria-label="mug-hot"></i> Take a Break
</p>
<!-- <p class="caption-text">*~ This is the end of Lesson 1 (of 2) ~*</p> -->
</div>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_2a521345" data-update-every="1" data-play-sound="true" tabindex="0" style="right:0;bottom:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>