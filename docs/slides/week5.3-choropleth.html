<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>EDS 240 – week5.3-choropleth</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="title-slide" class="slide level2 center" data-menu-title="Title Slide" data-background="#053660">
<h2></h2>
<p><span class="custom-title">EDS 240: Lecture 5.3</span></p>
<p><span class="custom-subtitle"><em>Colors &amp; Choropleths</em></span></p>
<hr class="hr-teal">
<p><span class="custom-subtitle3">Week 5 | February 5<sup>th</sup>, 2024</span></p>
</section>
<section id="making-map" class="slide level2" data-menu-title="# Map #" data-background="#047C90">
<h2></h2>
<div class="page-center vertical-center">
<p class="custom-subtitle bottombr">
Let’s explore county-level precipitation data using a choropleth map. Importantly, we’ll decide on a color palette / scale type and make any necessary adjustments.
</p>
</div>
</section>
<section id="choropleth" class="slide level2" data-menu-title="Choropleth">
<h2></h2>
<p><span class="slide-title">What’s a choropleth?</span></p>
<hr>
<div class="center-text">
<p>Choropleths are maps that display the <strong>spatial distribution of a variable</strong> across divided geographical areas / regions, where variable is <strong>encoded by color</strong>.</p>
</div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/week5/geopandas-choropleth.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="center-text gray-text body-text-s">
<p>Choropleth by <a href="https://ramiro.org/">Ramiro Gómez</a> using <a href="https://geopandas.org/en/stable/index.html">GeoPandas</a> (<a href="https://ramiro.org/notebook/geopandas-choropleth/">blog post</a>)</p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/week5/hanna-farnsworth-2013.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="center-text gray-text body-text-s">
<p>Choropleth by <a href="https://www.researchgate.net/publication/263851588_Visualizing_Virginia'_s_Changing_Electorate_Mapping_Presidential_Elections_from_2000_to_2012">Hanna &amp; Farnsworth (2013)</a></p>
</div>
</div>
</div>
<div class="fragment">
<div class="center-text">
<p>Choosing the right color palette <em>and</em> scale type are critically important. Oftentimes, you’ll need to adjust the default mapping of colors to accurately tell your story.</p>
</div>
</div>
</section>
<section id="data" class="slide level2" data-menu-title="The Data">
<h2></h2>
<p><span class="slide-title">The Data</span></p>
<hr>
<p><span class="body-text-s"><a href="https://www.ncei.noaa.gov/">NOAA National Centers for Environmental Information</a> (NCEI) is responsible for preserving, monitoring, assessing, and providing public access to the Nation’s geophysical data and information.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/week5/ncei-logo1.png" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/week5/ncei-logo2.png" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><span class="body-text-s">Find public access to a massive inventory of climate data on their <a href="https://www.ncei.noaa.gov/access/monitoring/products/">Climate Monitoring</a> page. Today’s lesson will use the <a href="https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/">Climate at a Glance</a> collection. Specifically, <strong>we’ll be exploring how precipitation across the continental US over the past 5 years compares to the 20th century average.</strong> To do so, we’ll work with county-level precipitation data, accessed via the <a href="https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/county/mapping/110/pcp/202312/60/value">County Mapping</a> portal.</span></p>
<!-- **we'll be exploring county-level precipitation data from October 2023, accessed via the [County Mapping](https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/county/mapping/110/pcp/202310/1/value) portal -- UPDATE THIS** -->
<!-- https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/county/mapping/110/pcp/202310/1/value -->
<!-- 5-year precip: https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/county/mapping/110/pcp/202312/60/value -->
</section>
<section id="tigris" class="slide level2" data-menu-title="{tigris}">
<h2></h2>
<p><span class="slide-title2">Use <code>{tigris}</code> to download shapefiles</span></p>
<hr>
<p>We can use the <a href="https://github.com/walkerke/tigris"><code>{tigris}</code> package</a> to download and use Census <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html">TIGER/Line shapefiles</a> in R.</p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/week5/tigris.png" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><br></p>
<ul>
<li><p>A <strong>shapefile</strong> is a vector data file format commonly used for geospatial analysis.</p></li>
<li><p>Shapefiles contain information for spatially describing features (e.g.&nbsp;points, lines, polygons), as well as any associated attribute information.</p></li>
<li><p>You can find / download shapefiles online (e.g.&nbsp;from the <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2023.html#list-tab-790442341">US Census Bureau</a>), or depending on the tools available, access them via packages (like we’re doing today).</p></li>
</ul>
</div>
</div>
<div class="footer">
<p>Check out <a href="https://walker-data.com/census-r/census-geographic-data-and-applications-in-r.html">Ch. 5</a> of <a href="https://walker-data.com/census-r/index.html">Analyzing US Census Data: Methods, Mpas, and Models in R</a> by <a href="https://personal.tcu.edu/kylewalker/">Kyle E. Walker</a> for a great intro to <code>{tigris}</code></p>
</div>
</section>
<section id="sf" class="slide level2" data-menu-title="simple features">
<h2></h2>
<p><span class="slide-title">Simple features in R</span></p>
<hr>
<div class="center-text">
<p>Spatial data can take many forms – <strong><span class="teal-text">simple features</span> is a standard that allows different types of software to specify spatial data in a common way.</strong></p>
</div>
<p><br></p>
<div class="fragment">
<p><strong>Simple features are comprised of:</strong></p>
<p><span class="body-text-s">1. a geometry object (e.g.&nbsp;a point, line, polygon) that describes where on Earth the feature is located</span></p>
<p><span class="body-text-s">2. attribute data associated with the geometry object (e.g.&nbsp;the precipitation across a county during the last 5 years)</span></p>
<p><br></p>
</div>
<div class="fragment">
<p><span class="body-text-s">Because of how <code>sf</code> objects are represented in R (they look like data frames!), <strong>simple features can be maniupulated and plotted by other well-known packages like <code>{dplyr}</code> and <code>{ggplot2}</code></strong>. Packages like <a href="https://r-spatial.github.io/sf/"><code>{sf}</code></a> provide tools for working with simple features (<code>sf</code> objects), but we’ll only need to rely on <code>{ggplot2}</code>s built-in <code>geom_sf()</code> geometry to plot our data.</span></p>
<p><br></p>
</div>
<div class="fragment">
<p>When we download our shapefile using <code>{tigris}</code>, <strong>it’ll be loaded as a simple features (<code>sf</code>) object</strong> with geometries that allow us to plot county lines. We’ll join our county-level precipitation data to our <code>sf</code> object so that we can color counties by precipitation.</p>
<!-- --- -->
<!-- ## {#shapefiles-simple-features data-menu-title="shapefiles & simple features"}  -->
<!-- [Working with shapefiles & simple features in R]{.slide-title2} -->
<!-- <hr> -->
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<!-- ::: {.center-text .body-text-s} -->
<!-- We can use the [`{tigris}` package](https://github.com/walkerke/tigris) to download and use Census [TIGER/Line shapefiles](https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html) in R. -->
<!-- ::: -->
<!-- ```{r} -->
<!-- #| eval: true -->
<!-- #| echo: false -->
<!-- #| out-width: "60%" -->
<!-- #| fig-align: "center" -->
<!-- knitr::include_graphics("images/week5/tigris.png") -->
<!-- ``` -->
<!-- ::: {.center-text .gray-text .body-text-s} -->
<!-- A **shapefile** is a vector data file format commonly used for geospatial analysis. The contain information for spatially describing features likes points, lines, and polygons, as well as any associated attribute information. You can find / download shapefiles online, or sometimes access them via packages (like we're doing today). -->
<!-- ::: -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- ```{r} -->
<!-- #| eval: true -->
<!-- #| echo: false -->
<!-- #| out-width: "70%" -->
<!-- #| fig-align: "center" -->
<!-- knitr::include_graphics("images/week5/sf.gif") -->
<!-- ``` -->
<!-- ::: {.center-text .body-text-s .gray-text} -->
<!-- The [`{sf}` package](https://r-spatial.github.io/sf/) provides tools for working with [simple features](https://r-spatial.github.io/sf/articles/sf1.html) in R.  -->
<!-- ::: -->
<!-- ::: -->
<!-- :::: -->
</div>
</section>
<section id="data-wrangling" class="slide level2" data-menu-title="Data wrangling">
<h2></h2>
<p><span class="slide-title">Data Wrangling</span></p>
<hr>
<p>Here, we’ll use the <code>{tigris}</code> package to import geometries for our US counties, then join it with our precipitation data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="do">##                                    setup                                 ----</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#..........................load packages.........................</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(tigris)</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#.........................get shape data.........................</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>county_geo <span class="ot">&lt;-</span> tigris<span class="sc">::</span><span class="fu">counties</span>(<span class="at">class =</span> <span class="st">"sf"</span>, <span class="at">cb =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="co"># cb = TRUE to use cartographic boundary files</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  </span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="co"># shift US to fit AK, HI, PR (we'll be filtering these out though) and transform CRS to USA Contiguous Albers Equal Area Conic (ESRI:102003) ----</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="fu">shift_geometry</span>()</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#....................import precipitation data...................</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>precip_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"week5"</span>, <span class="st">"data"</span>, <span class="st">"county-jan19-dec23-precip.csv"</span>), <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="do">##                               data wrangling                             ----</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>     </span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="do">##  ~ wrangle geometries  ----</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a>county_geo_wrangled <span class="ot">&lt;-</span> county_geo <span class="sc">|&gt;</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>  </span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="co"># clean up col names ----</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>  </span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="co"># rename county &amp; state cols ----</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="fu">rename</span>(<span class="at">county =</span> namelsad, <span class="at">state =</span> state_name) <span class="sc">|&gt;</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>  </span>
<span id="cb1-34"><a href="#cb1-34"></a>  <span class="co"># remove states / territories that we don't have precip data for ----</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="fu">filter</span>(<span class="sc">!</span>state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Alaska"</span>, <span class="st">"Hawaii"</span>, <span class="st">"District of Columbia"</span>,</span>
<span id="cb1-36"><a href="#cb1-36"></a>                       <span class="st">"United States Virgin Islands"</span>, <span class="st">"Puerto Rico"</span>, <span class="st">"American Samoa"</span>,</span>
<span id="cb1-37"><a href="#cb1-37"></a>                       <span class="st">"Commonwealth of the Northern Mariana Islands"</span>, <span class="st">"Guam"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>  </span>
<span id="cb1-39"><a href="#cb1-39"></a>  <span class="co"># capitalize "city" (VA) ----</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">str_replace</span>(<span class="at">string =</span> county, <span class="at">pattern =</span> <span class="st">" city"</span>, <span class="at">replacement =</span> <span class="st">" City"</span>))</span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="do">##  ~ wrangle precipitation data  ----</span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-45"><a href="#cb1-45"></a></span>
<span id="cb1-46"><a href="#cb1-46"></a>precip_wrangled <span class="ot">&lt;-</span> precip_data <span class="sc">|&gt;</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>  </span>
<span id="cb1-48"><a href="#cb1-48"></a>  <span class="co"># clean up col names ----</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-50"><a href="#cb1-50"></a>  </span>
<span id="cb1-51"><a href="#cb1-51"></a>  <span class="co"># rename county col ----</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>  <span class="fu">rename</span>(<span class="at">county =</span> name) <span class="sc">|&gt;</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>  </span>
<span id="cb1-54"><a href="#cb1-54"></a>  <span class="co"># filter out DC ----</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>  <span class="fu">filter</span>(<span class="sc">!</span>county <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Washington, D.C."</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-56"><a href="#cb1-56"></a>  </span>
<span id="cb1-57"><a href="#cb1-57"></a>  <span class="co"># update name to match that in county_geo df ----</span></span>
<span id="cb1-58"><a href="#cb1-58"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">str_replace</span>(<span class="at">string =</span> county, <span class="at">pattern =</span> <span class="st">"Dona Ana County"</span>, <span class="at">replacement =</span> <span class="st">"Doña Ana County"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>  </span>
<span id="cb1-60"><a href="#cb1-60"></a>  <span class="co"># coerce precip &amp; 20th centruy avg from chr to numeric ----</span></span>
<span id="cb1-61"><a href="#cb1-61"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value),</span>
<span id="cb1-62"><a href="#cb1-62"></a>         <span class="at">x1901_2000_mean =</span> <span class="fu">as.numeric</span>(x1901_2000_mean)) <span class="sc">|&gt;</span></span>
<span id="cb1-63"><a href="#cb1-63"></a>  </span>
<span id="cb1-64"><a href="#cb1-64"></a>  <span class="co"># calculate % change ----</span></span>
<span id="cb1-65"><a href="#cb1-65"></a>  <span class="fu">mutate</span>(<span class="at">perc_change =</span> ((value <span class="sc">-</span> x1901_2000_mean)<span class="sc">/</span>x1901_2000_mean)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-66"><a href="#cb1-66"></a>  </span>
<span id="cb1-67"><a href="#cb1-67"></a>  <span class="co"># select, rename, reorder cols ----</span></span>
<span id="cb1-68"><a href="#cb1-68"></a>  <span class="fu">select</span>(id, state, county, <span class="at">mean_1901_2000 =</span> x1901_2000_mean, <span class="at">precip =</span> value, perc_change, anomaly_1901_2000_base_period)</span>
<span id="cb1-69"><a href="#cb1-69"></a></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="do">##~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="do">##  ~ join dfs  ----</span></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="do">##~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="co"># join dfs (be sure to join precip TO sf object, not the other way around) -------</span></span>
<span id="cb1-75"><a href="#cb1-75"></a>joined_precip_geom <span class="ot">&lt;-</span> <span class="fu">full_join</span>(county_geo_wrangled, precip_wrangled) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- --- -->
<!-- DATA WRANGLING ALTERNATIVE: USING THE {maps} PACKAGE -->
<!-- Here, we'll wrangle our precipitation data, then join it with our US county data (courtesy of the [`{maps}` package](https://cran.r-project.org/web/packages/maps/index.html)): -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- #| echo: false -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##                                    setup                                 ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #..........................load packages......................... -->
<!-- library(tidyverse) -->
<!-- library(maps) -->
<!-- #.........................get shape data......................... -->
<!-- states <- map_data("state") -->
<!-- counties <- map_data("county") -->
<!-- #....................import precipitation data................... -->
<!-- precip_counties <- read_csv(here::here("slides", "data", "county-jan19-dec23-precip.csv"), skip = 4) |> -->
<!--   janitor::clean_names() -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##                               data wrangling                             ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #..............update names of counties df variables............. -->
<!-- us_counties <- counties |> -->
<!--   # select / rename cols of interest ---- -->
<!--   select(state = region, county = subregion, long, lat, group, order) |> -->
<!--   # make all county & state names Title Case ---- -->
<!--   mutate(county = str_to_title(county), -->
<!--          state = str_to_title(state)) |> -->
<!--   # fix different spellings so that they match county names in precip data ---- -->
<!--   mutate(county = case_when( -->
<!--     county == "De Kalb" ~ "DeKalb", -->
<!--     county == "De Soto" ~ "DeSoto", # works for FL & MI -->
<!--     county == "Du Page" ~ "DuPage", -->
<!--     county == "La Porte" ~ "LaPorte", -->
<!--     county == "Obrien" ~ "O'Brien", -->
<!--     county == "Prince Georges" ~ "Prince George's", -->
<!--     county == "Queen Annes" ~ "Queen Anne's", -->
<!--     county == "Ste Genevieve" ~ "Ste. Genevieve", -->
<!--     county == "La Moure" ~ "LaMoure", -->
<!--     state == "Texas" & county == "De Witt" ~ "DeWitt", -->
<!--     # county == "St. Marys" ~ "St. Mary's", # isn't working?? -->
<!--     TRUE ~ county -->
<!--     )) |> -->
<!--   mutate(county = str_replace(string = county, pattern = "St ", replacement = "St. ")) |> -->
<!--   # remove DC & Yellowstone National Park ---- -->
<!--   filter(!state %in% c("District Of Columbia")) |> -->
<!--   filter(!county %in% c("Yellowstone National")) -->
<!-- #..........clean precip data & make sure var names match......... -->
<!-- precip_counties_wrangled <- precip_counties |> -->
<!--   # more intuitive col name ---- -->
<!--   rename(county = name) |> -->
<!--   # make all county & state names lower case ---- -->
<!--   mutate(county = str_to_lower(county), -->
<!--          state = str_to_lower(state)) |> -->
<!--   # remove recurring patterns ---- -->
<!--   mutate(county = str_remove(county, pattern = " county")) |> # across all county names -->
<!--   mutate(county = str_remove(county, pattern = " parish")) |> # LA -->
<!--   # make state & county names Title Case again ---- -->
<!--   mutate(county = str_to_title(county), -->
<!--          state = str_to_title(state)) |> -->
<!--   # fix different spellings so that they match county names in precip data ---- -->
<!--   mutate(county = case_when( -->
<!--     county == "Dekalb" ~ "DeKalb", -->
<!--     county == "Desoto" ~ "DeSoto", # works for FL & MI -->
<!--     state == "Louisiana" & county == "De Soto" ~ "DeSoto", -->
<!--     county == "Dupage" ~ "DuPage", -->
<!--     county == "Lasalle" ~ "La Salle", -->
<!--     county == "Laporte" ~ "LaPorte", -->
<!--     county == "O'brien" ~ "O'Brien", -->
<!--     county == "Lamoure" ~ "LaMoure", -->
<!--     state == "Texas" & county == "Dewitt" ~ "DeWitt", -->
<!--     county == "St. Mary's" ~ "St. Marys", -->
<!--     county == "Suffolk City" ~ "Suffolk", -->
<!--     county == "Hampton City" ~ "Hampton", -->
<!--     county == "Virginia Beach City" ~ "Virginia Beach", -->
<!--     county == "Newport News City" ~ "Newport News", -->
<!--     county == "Norfolk City" ~ "Norfolk", -->
<!--     TRUE ~ county -->
<!--   )) |> -->
<!--   # remove DC & other non-counties -->
<!--   filter(!county %in% c("Washington, D.c.", "Alexandria City", "Bristol City")) |> -->
<!--   # coerce precip & 20th centruy avg from chr to numeric ---- -->
<!--   mutate(value = as.numeric(value), -->
<!--          x1901_2000_mean = as.numeric(x1901_2000_mean)) |> -->
<!--   # calculate % change ---- -->
<!--   mutate(perc_change = ((value - x1901_2000_mean)/x1901_2000_mean)*100) |> -->
<!--   # select & rename cols ---- -->
<!--   select(state, county, mean_1901_2000 = x1901_2000_mean, precip = value, perc_change, anomaly_1901_2000_base_period) -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##  ~ used to identify which county names don't match across dfs  ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- # unique_us_counties <- us_counties |> -->
<!-- #   distinct(state, county) -->
<!-- # -->
<!-- # unique_precip_counties <- precip_counties_wrangled |> -->
<!-- #   distinct(state, county) -->
<!-- # -->
<!-- # missing_from_us_counties <- anti_join(unique_precip_counties, unique_us_counties) |> -->
<!-- #   rename(county_in_us = county) -->
<!-- # -->
<!-- # missing_from_precip_counties <- anti_join(unique_us_counties, unique_precip_counties) |> -->
<!-- #   rename(county_in_precip = county) -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##  ~ ----------------------------------------------------------  ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #............................join dfs............................ -->
<!-- joined_precip_us_counties <- full_join(precip_counties_wrangled, us_counties) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- #| echo: false -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##                                    setup                                 ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #..........................load packages......................... -->
<!-- library(tidyverse) -->
<!-- library(maps) -->
<!-- #.........................get shape data......................... -->
<!-- states <- map_data("state") -->
<!-- counties <- map_data("county") -->
<!-- #....................import precipitation data................... -->
<!-- precip_counties <- read_csv(here::here("week5", "data", "county-jan19-dec23-precip.csv"), skip = 4) |> -->
<!--   janitor::clean_names() -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##                               data wrangling                             ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #..............update names of counties df variables............. -->
<!-- us_counties <- counties |> -->
<!--   # select / rename cols of interest ---- -->
<!--   select(state = region, county = subregion, long, lat, group, order) |> -->
<!--   # make all county & state names Title Case ---- -->
<!--   mutate(county = str_to_title(county), -->
<!--          state = str_to_title(state)) |> -->
<!--   # fix different spellings so that they match county names in precip data ---- -->
<!--   mutate(county = case_when( -->
<!--     county == "De Kalb" ~ "DeKalb", -->
<!--     county == "De Soto" ~ "DeSoto", -->
<!--     county == "Du Page" ~ "DuPage", -->
<!--     county == "La Porte" ~ "LaPorte", -->
<!--     county == "Obrien" ~ "O'Brien", -->
<!--     county == "Prince Georges" ~ "Prince George's", -->
<!--     county == "Queen Annes" ~ "Queen Anne's", -->
<!--     county == "Ste Genevieve" ~ "Ste. Genevieve", -->
<!--     county == "La Moure" ~ "LaMoure", -->
<!--     state == "Texas" & county == "De Witt" ~ "DeWitt", -->
<!--     TRUE ~ county -->
<!--     )) |> -->
<!--   mutate(county = str_replace(string = county, pattern = "St ", replacement = "St. ")) |> -->
<!--   # remove DC & Yellowstone National Park ---- -->
<!--   filter(!state %in% c("District Of Columbia")) |> -->
<!--   filter(!county %in% c("Yellowstone National")) -->
<!-- #..........clean precip data & make sure var names match......... -->
<!-- precip_counties_wrangled <- precip_counties |> -->
<!--   # more intuitive col name ---- -->
<!--   rename(county = name) |> -->
<!--   # make all county & state names lower case ---- -->
<!--   mutate(county = str_to_lower(county), -->
<!--          state = str_to_lower(state)) |> -->
<!--   # remove recurring patterns ---- -->
<!--   mutate(county = str_remove(county, pattern = " county")) |> -->
<!--   mutate(county = str_remove(county, pattern = " parish")) |> -->
<!--   # make state & county names Title Case again ---- -->
<!--   mutate(county = str_to_title(county), -->
<!--          state = str_to_title(state)) |> -->
<!--   # fix different spellings so that they match county names in precip data ---- -->
<!--   mutate(county = case_when( -->
<!--     county == "Dekalb" ~ "DeKalb", -->
<!--     county == "Desoto" ~ "DeSoto", -->
<!--     state == "Louisiana" & county == "De Soto" ~ "DeSoto", -->
<!--     county == "Dupage" ~ "DuPage", -->
<!--     county == "Lasalle" ~ "La Salle", -->
<!--     county == "Laporte" ~ "LaPorte", -->
<!--     county == "O'brien" ~ "O'Brien", -->
<!--     county == "Lamoure" ~ "LaMoure", -->
<!--     state == "Texas" & county == "Dewitt" ~ "DeWitt", -->
<!--     county == "St. Mary's" ~ "St. Marys", -->
<!--     county == "Suffolk City" ~ "Suffolk", -->
<!--     county == "Hampton City" ~ "Hampton", -->
<!--     county == "Virginia Beach City" ~ "Virginia Beach", -->
<!--     county == "Newport News City" ~ "Newport News", -->
<!--     county == "Norfolk City" ~ "Norfolk", -->
<!--     TRUE ~ county -->
<!--   )) |> -->
<!--   # remove DC & other non-counties -->
<!--   filter(!county %in% c("Washington, D.c.", "Alexandria City", "Bristol City")) |> -->
<!--   # coerce precip & 20th centruy avg from chr to numeric ---- -->
<!--   mutate(value = as.numeric(value), -->
<!--          x1901_2000_mean = as.numeric(x1901_2000_mean)) |> -->
<!--   # calculate % change ---- -->
<!--   mutate(perc_change = ((value - x1901_2000_mean)/x1901_2000_mean)*100) |> -->
<!--   # select & rename cols ---- -->
<!--   select(state, county, mean_1901_2000 = x1901_2000_mean, precip = value, perc_change, anomaly_1901_2000_base_period) -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##  ~ used to identify which county names don't match across dfs  ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- # unique_us_counties <- us_counties |> -->
<!-- #   distinct(state, county) -->
<!-- # -->
<!-- # unique_precip_counties <- precip_counties_wrangled |> -->
<!-- #   distinct(state, county) -->
<!-- # -->
<!-- # missing_from_us_counties <- anti_join(unique_precip_counties, unique_us_counties) |> -->
<!-- #   rename(county_in_us = county) -->
<!-- # -->
<!-- # missing_from_precip_counties <- anti_join(unique_us_counties, unique_precip_counties) |> -->
<!-- #   rename(county_in_precip = county) -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ##  ~ ----------------------------------------------------------  ---- -->
<!-- ##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- #............................join dfs............................ -->
<!-- joined_precip_us_counties <- full_join(precip_counties_wrangled, us_counties) -->
<!-- ``` -->
<!-- --- -->
</section>
<section id="base-map" class="slide level2" data-menu-title="Create base map">
<h2></h2>
<p><span class="slide-title">Start by creating a base map</span></p>
<hr>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>base_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(joined_precip_geom) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> perc_change), <span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"5-year precipitation compared with the 20th century average"</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>       <span class="at">subtitle =</span> <span class="st">"January 2019 - December 2023"</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>       <span class="at">caption =</span> <span class="st">"Source: National Centers for Environmental Information"</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>))</span>
<span id="cb2-11"><a href="#cb2-11"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a>base_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="center-text">
<p>Because we want to map precipitation relative to the 20th century average (e.g.&nbsp;has precipitation for a given region over the last 5 years been <em>above</em> or <em>below</em> the average), a <strong>divering color palette</strong> makes a lot of sense.</p>
</div>
<div class="footer">
<p>You may notice that Connecticut is missing most of its data. After some digging, I learned that CT recently (2022) replaced its eight counties with nine planning regions as county-equivalents (read more in the <a href="https://www.federalregister.gov/documents/2022/06/06/2022-12063/change-to-county-equivalents-in-the-state-of-connecticut">UC Census Bureau Notice on 06/06/2022</a>). I couldn’t quite make sense of how to match old county names to new planning regions, as there’s a decent amount of <a href="https://en.wikipedia.org/wiki/List_of_counties_in_Connecticut#/media/File:CT_Planning_vs_County_Census.png">geographic overlap</a>, soooo I gave up (for now) <i class="fa-solid fa-face-grin-beam-sweat" title="grinning face with sweat dripping from forehead" aria-label="face-grin-beam-sweat"></i>.</p>
</div>
<!-- --- -->
<!-- OLD  -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- #| echo: false -->
<!-- #| output-location: column -->
<!-- # 'group' controls whether adjacent points are connected by lines (each county is a "group," therefore points are connected) ---- -->
<!-- base_map <- ggplot(data = states, mapping = aes(x = long, y = lat, group = group)) + -->
<!--   # plot precip values by county; geom_polygon() drawn lines between points and “closes them up” (i.e. draws a line from the last point back to the first point) ---- -->
<!--   geom_polygon(data = joined_precip_us_counties, aes(fill = perc_change)) + -->
<!--   # darken state lines ---- -->
<!--   geom_polygon(color = "#2F2D2C", fill = NA, linewidth = 0.1) + -->
<!--   # update labels ---- -->
<!--   labs(title = "5-year precipitation compared with the 20th century average", -->
<!--        caption = "Source: National Centers for Environmental Information") + -->
<!--   # set theme to clean up appearance ---- -->
<!--   theme_void() + -->
<!--   # theme adjustments ---- -->
<!--   theme( -->
<!--     legend.position = "bottom", -->
<!--     legend.title = element_blank(), -->
<!--     plot.caption = element_text(face = "italic", margin = margin(t = 20, r = 0, b = 0, l = 0)) -->
<!--   ) -->
<!-- base_map -->
<!-- ``` -->
<!-- ::: {.center-text} -->
<!-- This looks a bit wonky, so we'll need to specify a projection, next. -->
<!-- ::: -->
<!-- ::: {.footer} -->
<!-- [Eric C. Anderson's](https://github.com/eriqande) [Making Maps with R](https://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html) tutorial was a wonderful resource in getting started with the `{maps}` package. -->
<!-- ::: -->
<!-- --- -->
<!-- ## {#map-projection data-menu-title="Map projection"} -->
<!-- [Apply a Mercator projection]{.slide-title} -->
<!-- <hr> -->
<!-- [Lambert conformal conic](https://en.wikipedia.org/wiki/Lambert_conformal_conic_projection) and [Mercator projections](https://en.wikipedia.org/wiki/Mercator_projection) are both commonly used for mapping the United States. Here, we'll apply the latter: -->
<!-- ```{r} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| fig-align: "center" -->
<!-- base_map_proj <- base_map + -->
<!--   coord_map(projection = "mercator") -->
<!-- base_map_proj -->
<!-- ``` -->
<!-- ::: {.notes} -->
<!-- Alternatively: -->
<!-- - fix the relationship between lat & long by using `coord_fixed(1.3)` -->
<!-- - apply a Lambert conformal projection, conic projection, using `coord_fixed(projection = "conic", lat0 = 30)` -->
<!-- - NOTE: `coord_map()` has been been superceded by `coord_sf()`: https://ggplot2.tidyverse.org/reference/coord_map.html -->
<!-- ::: -->
</div>
</section>
<section id="decide-on-scale-type" class="slide level2" data-menu-title="Decide on scale type">
<h2></h2>
<p><span class="slide-title">Classed or unclassed color scale?</span></p>
<hr>
<p>We’ve landed on a <strong>diverging color palette</strong>, but should we use a classed (aka binned) or unclassed (aka continuous) palette?</p>
<p><br></p>
<div class="fragment">
<p><strong>Use a <span class="teal-text">classed</span> color scale if you want to <span class="teal-text">communicate statistical brackets</span>:</strong> <img src="images/week5/classed.png" alt="A classed color scale with 5 binned colors ranging from dark green on the left to dark red on the right." style="display: inline-block; margin: 0; position: relative; top: 3px; width:80px;height:20px;"></p>
<ul>
<li><span class="body-text-s">the focus is on which data units fall into pre-defined classes, rather than overall pattern</span></li>
<li><span class="body-text-s">best if you want you audience to read values (gets more difficult with more classes; easier with interactive visualizations)</span></li>
<li><span class="body-text-s">the more classes you have, the more nuanced your map becomes</span></li>
</ul>
</div>
<div class="fragment">
<p><strong>Use an <span class="teal-text">unclassed</span> color scale if you want to <span class="teal-text">show general patterns</span>:</strong> <img src="images/week5/unclassed.png" alt="An unclassed color scale with colors that smoothly transition from dark green on the left to dark red on the right." style="display: inline-block; margin: 0; position: relative; top: 3px; width:80px;height:20px;"></p>
<ul>
<li><span class="body-text-s">the focus is on general patterns, rather than which statistical brackets regions fall into</span></li>
<li><span class="body-text-s">best if you don’t want to interpret for your reader – it makes it easier to see outliers, transitions to and comparisons with neighboring regions</span></li>
</ul>
<div class="footer">
<p>Adapted from <a href="https://blog.datawrapper.de/classed-vs-unclassed-color-scales/">When to use classed and when to use unclassed color scales</a>, by Lisa Charlotte Muth</p>
</div>
</div>
</section>
<section id="start-unclassed" class="slide level2" data-menu-title="Start unclassed">
<h2></h2>
<p><span class="slide-title">Start with an unclassed scale</span></p>
<hr>
<p><br></p>
<blockquote>
<p>“The unclassed choropleth is the most exact representation of the data model possible,”</p>
</blockquote>
<div class="right-align-text">
<p>-Judith A. Tyner, in <a href="https://www.amazon.com/Principles-Map-Design-Judith-Tyner/dp/1462517129">Priciples of Map Design</a></p>
</div>
<p><br></p>
<div class="fragment">
<blockquote>
<p>“No matter if you decide for a classed map at the end, you should <strong>start your process by looking at an unclassed map</strong>. This will help you see subtle differences between regions and make a conscious decision if and how you should simplify them.”</p>
</blockquote>
<div class="right-align-text">
<p>-Lisa Charlotte Muth, in <a href="https://blog.datawrapper.de/classed-vs-unclassed-color-scales/">When to use classed and when to use unclassed color scales</a></p>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="center-text body-text-m">
<p><strong>We’ll heed this advice and start with an unclassed map!</strong></p>
</div>
</div>
</section>
<section id="decide-on-palette" class="slide level2" data-menu-title="Decide on palette">
<h2></h2>
<p><span class="slide-title">Pick a color palette!</span></p>
<hr>
<p>Recall <a href="https://samanthacsik.github.io/EDS-240-data-viz/slides/week5.1-colors-slides.html#/suggested-colors">from earlier</a> that precipitation data is often encoded using a <strong>brown / blue</strong> color scheme (with drier conditions falling on the brown side and wetter conditions falling on the blue side).</p>
<p>Lucky for us, <strong>RColorBrewer</strong> has this exact palette. <strong>Let’s use <span class="teal-text">all 11 hues</span> for our unclassed map</strong>:</p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="center-text gray-text body-text-s">
<p>Preview the palette using <code>display.brewer.pal()</code> with our desired number of hues:</p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.pal</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">name =</span> <span class="st">'BrBG'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-9-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="center-text gray-text body-text-s">
<p>Save the HEX codes to a named object using <code>brewer.pal()</code> (we’ll call this in our plot later):</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>my_brew_palette11 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">name =</span> <span class="st">'BrBG'</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>my_brew_palette11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "#543005" "#8C510A" "#BF812D" "#DFC27D" "#F6E8C3" "#F5F5F5" "#C7EAE5"
 [8] "#80CDC1" "#35978F" "#01665E" "#003C30"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="apply-palette-unclassed" class="slide level2" data-menu-title="Apply our palette (unclassed)">
<h2></h2>
<p><span class="slide-title">Apply our palette &amp; adjust colorbar</span></p>
<hr>
<p><span class="body-text-s">Here, we leverage the awesome <code>{scales}</code> package to add <strong>%s</strong> to the colorbar labels and set our breaks. We also use <code>guides()</code> + <code>guide_colorbar()</code> to update label positioning and colorbar size:</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>base_map <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> my_brew_palette11,</span>
<span id="cb6-3"><a href="#cb6-3"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb6-4"><a href="#cb6-4"></a>                       <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="at">width =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                               <span class="at">barwidth =</span> <span class="dv">15</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="inspect-color-scale1" class="slide level2" data-menu-title="Inspect color scale">
<h2></h2>
<p><span class="slide-title">Inspect the color scale – anything off?</span></p>
<hr>

<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-12-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="misleading" class="slide level2" data-menu-title="Misleading colors">
<h2></h2>
<p><span class="slide-title">Our color mapping may be misleading</span></p>
<hr>

<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-13-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p><br></p>
<div class="center-text">
<p><strong>0%</strong> (i.e.&nbsp;no change between 5-year precipitation and 20th century average) <strong>is currently on the bluer side of our color scale</strong>, rather than on the off-white color that’s at the center of our palette.</p>
<p>As a result, <strong>our map may be misleading</strong> – it would appear as if more counties received higher-than-average precipitation than in actuality.</p>
</div>
</section>
<section id="rescale-colorbar" class="slide level2" data-menu-title="Rescale centerpoint">
<h2></h2>
<p><span class="slide-title2">Rescale the colorbar so that 0 is at the center</span></p>
<hr>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="5-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>base_map <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> my_brew_palette11,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb7-4"><a href="#cb7-4"></a>                       <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="at">width =</span> <span class="dv">10</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a>                       <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="at">x =</span> <span class="fu">c</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>                         <span class="fu">min</span>(<span class="fu">na.omit</span>(joined_precip_geom)<span class="sc">$</span>perc_change),</span>
<span id="cb7-7"><a href="#cb7-7"></a>                         <span class="dv">0</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                         <span class="fu">max</span>(<span class="fu">na.omit</span>(joined_precip_geom)<span class="sc">$</span>perc_change)))) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                               <span class="at">barwidth =</span> <span class="dv">15</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="final-unclassed" class="slide level2" data-menu-title="Final unclassed map">
<h2></h2>
<p><span class="slide-title">Our final unclassed map</span></p>
<hr>

<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="classed-palette" class="slide level2" data-menu-title="Classed palette">
<h2></h2>
<p><span class="slide-title">Modify our palette for our classed map</span></p>
<hr>
<p>We’ll be using the same color palette for our classed map, but this time, <strong>let’s keep <span class="teal-text">10 hues</span> (this will drop the middle-most off-white hue)</strong>:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="center-text gray-text body-text-s">
<p>Preview the palette using <code>display.brewer.pal()</code> with our desired number of hues:</p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.pal</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">name =</span> <span class="st">'BrBG'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-16-1.png" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="center-text gray-text body-text-s">
<p>Save the HEX codes to a named object using <code>brewer.pal()</code> (we’ll call this in our plot later):</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>my_brew_palette10 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">name =</span> <span class="st">'BrBG'</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>my_brew_palette10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "#543005" "#8C510A" "#BF812D" "#DFC27D" "#F6E8C3" "#C7EAE5" "#80CDC1"
 [8] "#35978F" "#01665E" "#003C30"</code></pre>
</div>
</div>
</div>
</div>
<p><span class="body-text-s">By dropping the off-white hue, we can construct our scale so that <strong>0%</strong> sits at the break point between brown and blue shades – any county that received more than the historical average will be a shade of blue, and any that received less will be a shade of brown.</span></p>
</section>
<section id="apply-palette-classed" class="slide level2" data-menu-title="Apply our palette (classed)">
<h2></h2>
<p><span class="slide-title">By default, our resolution is pretty low</span></p>
<hr>
<p>We only get 4 bins by default, which means we lose a lot of detail in our map:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>base_map <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">scale_fill_stepsn</span>(<span class="at">colors =</span> my_brew_palette10,</span>
<span id="cb11-3"><a href="#cb11-3"></a>                    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorsteps</span>(<span class="at">barwidth =</span> <span class="dv">25</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-18-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="increase-classes" class="slide level2" data-menu-title="Increase # of classes">
<h2></h2>
<p><span class="slide-title">More classes = more nuance</span></p>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<div class="center-text body-text-s">
<p>Breaks set to a width of <strong>10</strong></p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>base_map <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">scale_fill_stepsn</span>(<span class="at">colors =</span> my_brew_palette10,</span>
<span id="cb12-3"><a href="#cb12-3"></a>                    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb12-4"><a href="#cb12-4"></a>                    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="at">width =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorsteps</span>(<span class="at">barwidth =</span> <span class="dv">25</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:%;">
<div class="center-text body-text-s">
<p>Breaks set to a width of <strong>5</strong> &amp; rescaled with 0 at center</p>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" data-code-line-numbers="4-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>base_map <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">scale_fill_stepsn</span>(<span class="at">colors =</span> my_brew_palette10,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb13-4"><a href="#cb13-4"></a>                    <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="at">x =</span> <span class="fu">c</span>(</span>
<span id="cb13-5"><a href="#cb13-5"></a>                         <span class="fu">min</span>(<span class="fu">na.omit</span>(joined_precip_geom)<span class="sc">$</span>perc_change),</span>
<span id="cb13-6"><a href="#cb13-6"></a>                         <span class="dv">0</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>                         <span class="fu">max</span>(<span class="fu">na.omit</span>(joined_precip_geom)<span class="sc">$</span>perc_change))), </span>
<span id="cb13-8"><a href="#cb13-8"></a>                    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="at">width =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorsteps</span>(<span class="at">barwidth =</span> <span class="dv">25</span>, <span class="at">barheight =</span> <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="footer">
<p><em>But</em> the more classes you have, the longer it will (likely) take a reader to interpret values.</p>
</div>
</section>
<section id="unclassed-classed" class="slide level2" data-menu-title="Unclassed vs. classed">
<h2></h2>
<p><span class="slide-title">Unclassed vs.&nbsp;classed maps</span></p>
<hr>
<p>What stories to each of these maps tell? When might you choose one over the other? What additional modifications might you make?</p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="center-text body-text-s gray-text">
<p>Unclassed map:</p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-21-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:%;">
<div class="center-text body-text-s gray-text">
<p>Classed map:</p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week5.3-choropleth_files/figure-revealjs/unnamed-chunk-22-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="multiple-maps" class="slide level2" data-menu-title="Multiple maps">
<h2></h2>
<p><span class="slide-title">Choropleths are powerful in multiples</span></p>
<hr>
<p>Several maps side-by-side can help you better spot important patterns and tell a more complete story.</p>

<img data-src="images/week5/nyt-precip.png" style="width:100.0%" class="r-stretch quarto-figure-center"><div class="footer">
<p><a href="https://www.nytimes.com/2021/09/16/learning/whats-going-on-in-this-graph-new-normal-us-precipitation.html">What’s Going On in This Graph? | New Normal U.S. Precipitation</a> (New York Times)</p>
</div>
</section>
<section id="end-break" class="slide level2" data-menu-title="# END #" data-background="#047C90">
<h2></h2>
<div class="page-center vertical-center">
<p class="custom-subtitle bottombr">
See you next week!
</p>
<p class="caption-text">
<em>~ This is the end of Lesson 3 (of 3) ~</em>
</p>
</div>
<!-- ##  {#end-break data-menu-title="# Break #" background="#047C90"} -->
<!-- <div class="page-center vertical-center"> -->
<!-- <p class="custom-subtitle bottombr"> Take a Break</p> -->
<!-- <p class="caption-text">*~ This is the end of Lesson 1 (of 3) ~*</p> -->
<!-- </div> -->
<!-- ```{r} -->
<!-- countdown::countdown( -->
<!--   minutes = 5, -->
<!--   # left = 0, right = 0, -->
<!--   # Fanfare when it's over -->
<!--   play_sound = TRUE, -->
<!--   color_border              = "#FFFFFF", -->
<!--   color_text                = "#7aa81e", -->
<!--   color_running_background  = "#7aa81e", -->
<!--   color_running_text        = "#FFFFFF", -->
<!--   color_finished_background = "#ffa07a", -->
<!--   color_finished_text       = "#FFFFFF", -->
<!--   font_size = "2em", -->
<!--   ) -->
<!-- ``` -->

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>